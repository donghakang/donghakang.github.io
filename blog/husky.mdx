---
title: husky ğŸ¶, lint-staged, commitlint
author: 'Dongha Kang'
date: '2022-04-10'
tag: ['husky', 'lint-staged']
---

![Husky..?](/img/husky.png)

git hooksëŠ” í”íˆ gitì— pushí•˜ê¸° ì „ ë°œìƒí•˜ëŠ” ì‹¤ìˆ˜ë¥¼ ë°©ì§€í•˜ê¸°ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.
í”íˆ ë°œê²¬ë˜ëŠ” ì‹¤ìˆ˜ë¡œëŠ” ESLintê°€ ì œëŒ€ë¡œ ì ìš©ì´ ë˜ì—ˆëŠ”ì§€, ë” ë‚˜ì•„ê°€ì„œëŠ” Prettierê°€ ì œëŒ€ë¡œ ì ìš©ì´ ë˜ì–´ìˆëŠ”ì§€ í™•ì¸ì„ í•˜ê³  pushë¥¼ í•œë‹¤ë©´ í˜‘ì—…ì— ë„ì›€ì´ ë§ì´ ë˜ê¸° ë•Œë¬¸ì— ì£¼ë¡œ ì‚¬ìš©ëœë‹¤.

ì´ git hooksë¥¼ ë” í¸ë¦¬í•˜ê²Œ í•˜ê¸°ìœ„í•´ **husky**ë¼ëŠ” í”„ë¡œê·¸ë¨ì´ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.

**lint-staged**ëŠ” linterë“¤ì„ git add ê°€ ëœ íŒŒì¼ë“¤ì— í•œì • ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.

ë§Œì•½ ESLintì™€ Prettierë¥¼ ì œëŒ€ë¡œ ì„¤ì •í–ˆë‹¤ê³  ê°€ì •í•˜ì (ë§Œì•½ ì„¤ì •í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ì—¬ê¸°ì—ì„œ ì„¤ì • ë°©ë²•ì„ ì•Œì•„ë³´ì)

---

## ğŸ—Â ì„¤ì¹˜

```jsx
npx husky-init && npm i
```

ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ `.husky` ë¼ëŠ” í´ë”ê°€ ìƒì„±ëœ ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìœ¼ë©° ê·¸ ì•ˆì—ëŠ” `_`ë¼ëŠ” í´ë”ì™€ `pre-commit`ì´ë¼ëŠ” shell scriptê°€ ìˆë‹¤.

```jsx
npx mrm@2 lint-staged
```

ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´, `package.json` ì™€ `.husky` ê°€ ì—…ë°ì´íŠ¸ ë˜ëŠ”ë°, `package.json` ì—ì„œëŠ” â€œlint-stagedâ€ ë¼ëŠ” ë¬¸êµ¬ê°€ ì¶”ê°€ê°€ ëœë‹¤

---

## ğŸ¶Â husky!

ë‹¤ìš´ë¡œë“œ ì™„ë£Œê°€ ëœ huskyëŠ” ì¶”ê°€ì ì¸ ì„¤ì •ì´ í•„ìš”í•˜ë‹¤. ê·¸ê²ƒì€ huskyë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„  ê·¸ ì˜ ë§ëŠ” git hookì„ ì¶”ê°€í•´ì•¼í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ê·¸ëŸ¬ê¸° ìœ„í•´ì„  .husky ì˜ ë˜ ë‹¤ë¥¸ ëª…ë ¹ì–´ `npx husky add` ë¥¼ ì‚¬ìš© í•´ì•¼í•˜ëŠ”ë° ì •ì‹ í™ˆí˜ì´ì§€ì— ë‚˜ì™€ìˆëŠ” ì˜ˆì‹œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

```bash
npx husky add .husky/commit-msg 'npx --no-install commitlint --edit "$1"'
```

> ê¸°ì¡´ husky@4 ì—ì„œëŠ” .huskyrc ë¼ëŠ” íŒŒì¼ì„ ìƒì„±í•´ì„œ ëª…ë ¹ì–´ë“¤ì„ ìˆ˜ì •í•˜ê±°ë‚˜ ì—…ê·¸ë ˆì´ë“œ ì‹œí‚¬ìˆ˜ ìˆì—ˆì§€ë§Œ ì´ì œëŠ” shell scriptë¥¼ ì¨ì•¼í•œë‹¤ëŠ” ë¶ˆí¸í•¨ì„ ëŠë¼ëŠ” ì‚¬ëŒë“¤ë„ ê½¤ ìˆì–´ì„œ husky@4ë¥¼ ì„ í˜¸ í•˜ì‹œëŠ” ê°œë°œìë“¤ë„ ë§ì€ ê²ƒ ê°™ë‹¤. ë‚˜ëŠ” ìµœì‹ ì‹ì„ ì‚¬ìš©í•  ê³„íšì´ë‹¤! ë‹¤ì‹œ ë³¸ë¡ ìœ¼ë¡œ ë“¤ì–´ê°€ì„œ ..

ì € ëª…ë ¹ì–´ê°€ í•˜ëŠ” ë§ì€ `.husky` ë¼ëŠ” í´ë”ì— `commit-msg` ë¼ëŠ” script ì•ˆì— `npx ...` ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤ëŠ” ê²ƒì´ë‹¤. ì¦‰ commit ë©”ì‹œì§€ë¥¼ ì™„ì„±í•œ í›„ì— `npx commitlint`ë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤.

huskyëŠ” ì‚¬ìš©ë˜ëŠ” shell script ì´ë¦„ë“¤ì´ ì •í•´ì ¸ìˆë‹¤.

- **pre-commit**: commitì„ ì‹¤í–‰í•˜ê¸° ì „ì— ì‹¤í–‰
- **prepare-commit-msg**: commit ë©”ì‹œì§€ë¥¼ ìƒì„œí•˜ê³  í¸ì§‘ê¸° ì‹¤í–‰ ì „ì— ì‹¤í–‰
- **commit-msg**: commit ë©”ì‹œì§€ë¥¼ ì™„ì„±í•œ í›„ì— ì‹¤í–‰
- **post-commit**: commit ì™„ë£Œ í›„ ì‹¤í–‰

- **applypatch-msg**: git amì„ ì‹¤í–‰í•˜ê¸° ì „ì— ì‹¤í–‰
- **pre-applypatch**: patch ì ìš© í•  ë•Œ ì‹¤í–‰. patch ì¤‘ë‹¨ ê°€ëŠ¥
- **post-applypatch**: git am ëª…ë ¹ ë§ˆì§€ë§‰ì— ì‹¤í–‰. patch ì¤‘ë‹¨ ë¶ˆê°€ëŠ¥

- **pre-rebase**: rebase í•˜ê¸° ì „ì— ì‹¤í–‰
- **post-rewrite**: git commit -amend, git rebase ì²˜ëŸ¼ ì»¤ë°‹ ë³€ê²½ í•œ í›„ ì‹¤í–‰
- **post-merge**: merge í›„ ì‹¤í–‰
- **pre-push**: push í• ë•Œ ì‹¤í–‰. ì „ì†¡í•˜ê¸° ì „ì— ì‹¤í–‰í•˜ê¸° ë•Œë¬¸ì— ì¤‘ë‹¨ ê°€ëŠ¥

ì…ë§›ì— ë§ì¶°ì„œ `npx husky add .husky/<script command> â€˜<run script>â€™` ë¥¼ ì‹¤í–‰ ì‹œí‚¤ë©´ ëœë‹¤.

---

## ğŸ–‡Â Lint-staged

ì•ì„œ ë§í–ˆë“¯, lint-staged ë¥¼ ì‚¬ìš©í•˜ë©´ package.json ê³¼ .husky í´ë”ì•ˆì´ ë³€ê²½ì´ ë˜ëŠ”ë°

```json
// package.json
{
	...
	"lint-staged": {
    "*.js": "eslint --cache --fix"
  }
}
```

package.jsonì•ˆì— ì € ë¬¸êµ¬ê°€ í•˜ëŠ”ë§ì€ `*.js` ì— í•´ë‹¹ë˜ëŠ” íŒŒì¼ë“¤ì„ `eslint --cache --fix` ë¥¼ ì´ìš©í•´ eslintë¥¼ í™•ì¸ í•˜ê²Œ ëœë‹¤.

.husky í´ë” ì•ˆì—ëŠ” `pre-commit` ë¼ëŠ” ìƒˆë¡œìš´ íŒŒì¼ì´ ìƒê²¨ë‚œ ê²ƒì„ (ìˆ˜ì • ê²ƒì„) í™•ì¸ í•  ìˆ˜ ìˆë‹¤. ê·¸ ì•ˆì„ í™•ì¸í•˜ë©´

```bash
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

yarn lint-staged
```

â€œcommit ì„ í•  ë•Œ, `yarn lint-staged` ê°€ ì‹¤í–‰ ë ê±°ì•¼â€ ë¼ëŠ” ê²ƒì„ ì‰½ê²Œ ì˜ˆì¸¡í•  ìˆ˜ ìˆë‹¤.

**ì¦‰, lint-staged ë¥¼ `npx mrm@2` ë¥¼ ì´ìš©í•´ì„œ ë‹¤ìš´ë¡œë“œë§Œ í•œë‹¤ë©´, ì•ìœ¼ë¡œ ì»¤ë°‹ì„ í•  ë•Œ, ëª¨ë“  .js íŒŒì¼ì— í•œì—ì„œ eslintê°€ ì œëŒ€ë¡œ ì ìš©ì´ ë˜ì—ˆëŠ”ì§€ í™•ì¸ í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.**

ì‹¤ì œë¡œ, eslintë¥¼ ì–´ê¸°ê³  ì»¤ë°‹í•˜ë©´ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.

ê·¸ë ‡ë‹¤ë©´, prettierë„ ì ìš©í•´ë³´ì.

```json
// package.json
{
	...
	"lint-staged": {
    "src/**/*.{ts,tsx,js,jsx,json}": "eslint --cache --fix",
    "src/**/*.{js,jsx,ts,tsx,json,css,scss,md}": "prettier --write"
  }
}
```

ì°¸ ì‰½ì£  ?

ì‚´ì§ ë˜ ì¶”ê°€í•œ ë¶€ë¶„ì€, ì´ì œëŠ” ëª¨ë“  .js íŒŒì¼ì´ ì•„ë‹Œ src/ ì•ˆì— ì¡´ì¬í•˜ëŠ” ts, tsx, js, jsx, json ì— í•œì—ì„œ eslintë¥¼ ì‹¤í–‰í•˜ê³ . ë˜ ê·¸ í›„ì—ëŠ” css, scss, md ë¥¼ í¬í•¨í•œ src ì•ˆì— ìˆëŠ” íŒŒì¼ë“¤ì— prettierë¥¼ ì ìš©í•œë‹¤.

---

## ğŸ“Â commitlint

git ì—ì„œ ì»¤ë°‹ì„ í•  ë•Œ, íŒ€ì›ê³¼ì˜ ì†Œí†µì„ ìœ„í•´ì„œ, í¸ë¦¬í•œ ê³¼ê±° ê¸°ë¡ ì¶”ì ì„ ìœ„í•´ì„œ commit ë©”ì‹œì§€ì— ëŒ€í•´ì„œ ì‹ ê²½ì„ ë§ì´ ì“´ë‹¤.

ê·¸ê²ƒ ë˜í•œ husky ê°€ ê´€ë¦¬ë¥¼ í•´ì¤„ ìˆ˜ ìˆëŠ”ë°. ì´ê²ƒì„ ë„ì™€ì£¼ëŠ” ê²ƒì´ ë°”ë¡œ commitlint ì™€ gitmoji ì´ë‹¤.

```bash
npm install --save-dev @commitlint/config-conventional @commitlint/cli
```

commitlintë¥¼ ë‹¤ìš´ë¡œë“œ í•œë‹¤.

```bash
echo "module.exports = {extends: ['@commitlint/config-conventional']}" > commitlint.config.js
```

eslintì™€ ìƒë‹¹íˆ ë¹„ìŠ·í•œ í¬ë§·ìœ¼ë¡œ commitlintë„ ì§„í–‰ì´ ë˜ëŠ”ë°, ì´ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ê¸°ì¡´ì— ìˆë˜ husky ì— commitlintë¥¼ ì´ìš©í•´ commit messageë¥¼ í™•ì¸í•´ì£¼ë„ë¡í•˜ì

```bash
npx husky add .husky/commit-msg 'npx --no -- commitlint --edit $1'
```

ì´ ì´í›„ì— git commit ì„ ì‹¤í–‰í•˜ê³  messageê°€ commitlint ì™€ ë¹„ìŠ·í•˜ì§€ ì•Šë‹¤ë©´ ë°”ë¡œ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤. ì•„ë˜ëŠ” ì˜ˆì‹œ

```bash
git commit -m "foo: foo"
â†’ No staged files match any configured task.
â§—   input: foo: foo
âœ–   Please add rules to your `commitlint.config.js`
    - Getting started guide: https://git.io/fhHij
    - Example config: https://git.io/fhHip [empty-rules]

âœ–   found 1 problems, 0 warnings
â“˜   Get help: https://github.com/conventional-changelog/commitlint/#what-is-commitlint

husky - commit-msg hook exited with code 1 (error)
```

---

## â˜ºï¸Â gitmoji

commit ì€ ì†”ì§íˆ ì´ë»ì•¼ ì œë§›. ì´ì œ Emoji ë„ ë„£ì–´ì£¼ì.

ìš°ì„  gitmojiì— ê´€ë ¨ëœ commitlintë¥¼ ë„£ì–´ì£¼ì

```bash
npm i -D commitlint-config-gitmoji commitlint
```

gitmojië¥¼ commitlint ì•ˆì— ë„£ì–´ì¤€ë‹¤.

```bash
echo "module.exports = {extends: ['gitmoji']};" > .commitlintrc.js
```

gitmoji ë¦¬ìŠ¤íŠ¸ëŠ” [ì´ê³³](https://gitmoji.dev/)ì—ì„œ í™•ì¸í•˜ì

ì´ê±°ëŠ” ë‚˜ì˜ rule.

```bash
:sparkles: feat: <ìƒˆë¡œìš´ featureê°€ ì¶”ê°€ë  ë•Œ>
:truck: chore: <ì˜®ê¸°ê±°ë‚˜ íŒŒì¼ì´ë¦„ì„ ë°”ê¾¸ì–´ì„œ ì‹¤ì œì ì¸ ì½”ë“œì™€ëŠ” ìƒê´€ì´ ì—†ì„ë•Œ>
:construction_worker: ci: <CI ì— ê´€ë ¨ëœ ë¹Œë“œë¥¼ í• ë•Œ>
:memo: docs: <ë„íë©˜íŠ¸>
:recycle: refactor: <ë¦¬íŒ©í† ë§>
:test_tube: test: <í…ŒìŠ¤íŠ¸ ì½”ë“œ>
:lipstick: style: <ìŠ¤íƒ€ì¼>
:rewind: revert: <ê¹ƒì„ ì˜ˆì „ ë‹¨ê³„ë¡œ ëŒë ¤ë†“ëŠ”ë‹¤>
:zap: perf: <ì†ë„ì ì¸ ì¸¡ë©´ì—ì„œ ì—…ê·¸ë ˆì´ë“œ ë ë•Œ>
:bug: fix: <ì˜¤ë¥˜ë¥¼ ë°”ê¾¼ë‹¤>
```

---

## ğŸ§¹Â ì •ë¦¬!

1. ESLint ì™€ Prettierë¥¼ ì„¤ì •í•œë‹¤.
2. lint-staged ë¥¼ ì„¤ì •í•˜ì (huskyê°€ ìë™ìœ¼ë¡œ ì„¤ì •ëœë‹¤!)
3. commitlintì™€ commitlint-config-gitmojië¥¼ ê°™ì´ ì„¤ì •í•œë‹¤ !
