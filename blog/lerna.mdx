---
title: Lerna, Spring boot ğŸŒ±
author: "Dongha Kang"
date: "2021-11-05"
tag: ["JavaScript", "Spring Boot", "React"]
---


# ì˜¤ëŠ˜ í•´ë³¸ ê²ƒ

- ë¸”ë¡œê·¸ì—ì„œ navigateì— absolute ê²½ë¡œë¡œ ë°”ê¾¸ì–´ì„œ ì‹¤ì œ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ì•ˆì—ì„œë„ ì¹´í…Œê³ ë¦¬ë¥¼ ê³¨ë¼ë³¼ ìˆ˜ ìˆë„ë¡ ì„¤ì • í•´ë³´ì•˜ë‹¤.
  
  ```jsx
  import { navigate } from "@reach/router"
  
  ...
  navigate(`/blog?tag=${key}`)
  ...
  ```
  
- ì†”ì§íˆ ì˜¤ëŠ˜ì€ ë¸”ë¡œê·¸ëŠ” ë§ì´ ëª»í•˜ê³  .. Lernaì™€ Spring framework, ê·¸ë¦¬ê³  postgresqlì— ëŒ€í•´ì„œ ë” ë§ì´ ì°¾ì•„ë³¸ê²ƒ ê°™ë‹¤...  ê·¸ëŸ¬ë¯€ë¡œ ì˜¤ëŠ˜ ë°°ìš´ê²ƒì— ë” ë§ì´ ê¸€ì„ ì¨ë³´ê² ë‹¤!

# ì˜¤ëŠ˜ ë°°ìš´ ê²ƒ

### Lerna

<aside>
ğŸ’¡ lerna ë€, 
ë‹¤ì–‘í•œ ë ˆí¬ì§€í† ë¦¬ë¥¼ ì‚¬ìš©í•  ì‹œ, ë¶ˆí¸í•˜ê³  ë”ëŸ¬ìš´ ì½”ë“œë¥¼ ì •ë¦¬í•´ì£¼ë©°. ë˜í•œ, Babel, React, Angular, Ember, ë“± ë‹¤ì–‘í•œ ë‹¤ì¤‘ íŒ¨í‚¤ì§€ ë¦¬í¬ì§€í† ë¦¬ë¥¼ í•œê°œì˜ ë¦¬í¬ì§€í† ë¦¬ë¡œ ë³€í™˜ í•´ì¤„ë•Œ ìœ ìš©í•˜ê²Œ ì“°ì´ëŠ” ë„êµ¬ ì…ë‹ˆë‹¤.
ì¦‰, **git/ npm ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ì¤‘ íŒ¨í‚¤ì§€ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ê´€ë¦¬í•˜ëŠ” ì‘ì—…ì„ ìµœì í™” í•´ì£¼ëŠ” ë„êµ¬ ì…ë‹ˆë‹¤.**

</aside>

- Lernaì— ëŒ€í•œ ëª¨ë“  ê²ƒ
  
  @[https://github.com/ahmadawais/lerna-tutorial](https://github.com/ahmadawais/lerna-tutorial)
  
  ## Why Lerna?
  
  í•œ ê°œì˜ Git í”„ë¡œì íŠ¸ì—ì„œ ì—¬ëŸ¬ê°œì˜ git projectë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆì—ˆì„ ê²ƒì´ë‹¤. í˜¹ì€ í•œê°œì˜ í”„ë¡œì íŠ¸ì•ˆì— ì—¬ëŸ¬ê°œì˜ ë¦¬í¬ì§€í† ë¦¬ê°€ ìƒì„±ì´ ë˜ëŠ” ê²½ìš°ë„ ìˆì—ˆì„ ê²ƒì´ë‹¤. 
  
  ê·¸ëŸ´ë•Œ, git submoduleì„ ì‚¬ìš© í•œ ê²½í—˜ì´ ìˆì„ê²ƒì´ë‹¤. git submodule ë˜í•œ ì—„ì²­ë‚˜ê²Œ ìœ ìš©í•˜ê²Œ ì“°ì´ì§€ë§Œ, ê°™ì€ repository ì— í•œ ê°œì˜ branchë§Œ ì‚¬ìš©ì´ ê°€ëŠ¥í–ˆì—ˆê³ , ê·¸ê²ƒì„ íŠ¸ë™í‚¹ í•˜ê±°ë‚˜ ì•½ê°„ì˜ ë¶ˆí¸í•¨ì„ ê°œì„ í•˜ê¸° ìœ„í•´ Mono-repoë¡œ ë§Œë“¤ì–´ë²„ë¦¬ëŠ” ì‘ì—…ì„ ì‹¤ì‹œí•˜ê¸° ìœ„í•´ Lernaë¥¼ ì‚¬ìš©í•˜ë©´ ì¢‹ë‹¤.
  
  ```jsx
  proj
  â”œâ”€â”€ repo1
  â”‚Â Â  â”œâ”€â”€ node_modules
  â”‚Â Â  â””â”€â”€ package.json
  â”œâ”€â”€ repo2
  â”‚Â Â  â”œâ”€â”€ node_modules
  â”‚Â Â  â””â”€â”€ package.json
  â”œâ”€â”€ repo3
  â”‚Â Â  â”œâ”€â”€ node_modules
  â”‚   â””â”€â”€ package.json
  â”œâ”€â”€ package.json
  â””â”€â”€ lerna.json
  ```
  
  ## Getting Started
  
  ```bash
  npm install --global lerna
  
  lerna init
  ```
  
  ì•„ë˜ì™€ ê°™ì´ lernaë¥¼ ì„¤ì¹˜ í•œ í›„ì—ëŠ” lerna.json ì´ë¼ëŠ” configuration íŒŒì¼ì´ ìƒì„±ì´ ë©ë‹ˆë‹¤.
  
  lerna.conf íŒŒì¼ ì•ˆì—ëŠ” ì•„ë˜ì™€ ê°™ì€ ì½”ë“œê°€ ìˆë‹¤.
  
  ```jsx
  // lerna.json (not an initial code)
  {
    "version": "independent",
    "packages": ["extensions/*", "platform/*"],
    "npmClient": "yarn",
    "useWorkspaces": true,
    "command": {
    "publish": {
      "ignoreChanges": ["*.md", "*.yml", "*.spec.js", "*.test.js"],
      "message": "chore(release): publish"
    },
    "version": {
      "allowBranch": "master",
      "conventionalCommits": true,
      "createRelease": "github",
      "yes": true,
      "message": "chore(release): publish [skip ci]"
    }
    }
  }
  ```
  
  - *packages*: ë‹¤ë¥¸ package.json ì´ ìˆëŠ” ìƒìœ„ í´ë”
  - *npmClient*: ì–´ë–¤ toolë¡œ build í•  ê²ƒì¸ì§€ (í›„ì— yarn workspaceë¥¼ ì• ìš©í•  ì˜ˆì •ì´ë‹ˆ, ê°œì¸ì ìœ¼ë¡œ yarnì´ ì¢‹ë‹¤)
  - *useWorkspaces:* yarn workspace ë„ ê°™ì´ ì“°ê¸° ìœ„í•´ true ë¡œ ì„¤ì •í•œë‹¤.
  
  ## lerna bootstrap
  
  ê°ê°ì˜ package.json ì— ìˆëŠ” dependencyì— npm installì„ í•´ì„œ ì„¤ì¹˜ë¥¼ í•´ì£¼ëŠ” ì‘ì—…ì´ ë°”ë¡œ lerna bootstrap ì´ë‹¤.
  
  **`lerna bootstrap â€”hoist`**ë¼ëŠ” ì˜µì…˜ë„ ì¶”ê°€í•´ ì¤€ë‹¤ë©´ ê³µí†µë˜ëŠ” ëª¨ë“ˆì„ ë£¨íŠ¸ì˜ node_modulesë¡œ ì˜¬ë ¤ì„œ ì„¤ì¹˜í•˜ê³ , ê°ê°ì˜ íŒ¨í‚¤ì§€ê°€ ë‹¤ë¥¸ ë²„ì „ì˜ ì™¸ë¶€ ë””íœë˜ì‹œë¥¼ ì‚¬ìš©í•˜ë©´ ì œì¼ ë§ì´ ì‚¬ìš©ë˜ëŠ” ë²„ì „ì´ í˜¸ì´ìŠ¤íŒ…ì´ ë˜ë©° ê²½ê³  ë˜í•œ ë³´ì—¬ì§‘ë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ì €ì¥ ê³µê°„ì´ ì¤„ê³ , ì¢…ì†ì„± ì„¤ì¹˜ì‹œê°„ì´ ê°ì†Œë˜ë©°, ë™ì¼í•œ pkg ë²„ì „ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  
  ë§Œì•½ ì„¤ì¹˜ê°€ ì˜ëª»ë  ì‹œ, `**lerna clean`** ì„ ì‚¬ìš©í•˜ì—¬ packageì˜ ëª¨ë“  node_modules ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  
  ## ê·¸ ì™¸ì˜ lerna ëª…ë ¹ì–´
  
  - `lerna version` : ë§ˆì§€ë§‰ git commit ê³¼ í˜„ì¬ íŒ¨í‚¤ì§€ì˜ ë²„ì „ì˜ ì°¨ì´ì ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.
  - `lerna publish`: íŒ¨í‚¤ì§€ë¥¼ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ë°°í¬í•©ë‹ˆë‹¤
  - `lerna run`: íŒ¨í‚¤ì§€ package.jsonì•ˆì— ëª…ì‹œë˜ì–´ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. (learn run dev)
  

### Spring boot â€” Jpa â€” Postgres

- Springì— ëŒ€í•˜ì—¬
  
  ## Why Spring boot ?
  
  Spring FrameworkëŠ” ìë°” ê¸°ë°˜ì˜ Backend server framework ì´ê³  _____
  
  Spring BootëŠ” Spring Frameworkì˜ ë” ì—…ê·¸ë ˆì´ë“œ (?) ëœ ë²„ì „ ì´ë©°, ê°„ë‹¨í•˜ê²Œ [start.spring.io](http://start.spring.io) ì—ì„œ initialize í•œë’¤, runì„ í•¨ìœ¼ë¡œì„œ ë°”ë¡œ apië¥¼ ì‹¤í–‰ ì‹œí‚¬ ìˆ˜ ìˆëŠ” ê°•ì ì´ ìˆë‹¤. ë˜í•œ, Spring Framework ë³´ë‹¤ ì½”ë“œë„ ë” ë‹¨ìˆœí•´ ì§„ë‹¤.
  
  ```bash
  backend/src/main/java/com/example/backend
  â”œâ”€â”€ BackendApplication.java
  â””â”€â”€ student
    â”œâ”€â”€ Student.java
    â”œâ”€â”€ StudentConfig.java
    â”œâ”€â”€ StudentController.java
    â”œâ”€â”€ StudentRepository.java
    â””â”€â”€ StudentService.java
  ```
  
  - ```BackendApplication.java```: ê°€ì¥ ê¸°ë³¸ì ì¸ java start ì½”ë“œ ì´ë©°, ì´ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ì½”ë“œê°€ ì‹œì‘ëœë‹¤.
  - ```Student.java```: Entity í´ë˜ìŠ¤
  - ```StudentController.java```: Get, Post, Insert, Update ì»¤ë§¨ë“œë¥¼ ë°›ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ ì´ë‹¤
  - ```StudentService.java```: Business ë¡œì§ì„ ê°€ì§€ê³  ìˆëŠ” í´ë˜ìŠ¤ ì´ë‹¤. í”íˆ StudentServiceImpl ë¼ëŠ” ë‹¤ë¥¸ í´ë˜ìŠ¤ë¡œ ë‚˜ëˆ„ê¸°ë„ í•œë‹¤. [ë§í¬](https://www.tutorialspoint.com/spring_boot/spring_boot_service_components.htm)
  - ```StudentRepository.java```: ë‚˜ì˜ ì˜ˆì‹œ ê°™ì€ê²½ìš° `JpaRepository<T, ID>` ë¥¼ ì´ìš©í•˜ì—¬ ì‹¤ì œ ë°ì´í„° ë² ì´ìŠ¤ì™€ ì—°ê²° ì‹œì¼œì£¼ëŠ” í´ë˜ìŠ¤ ì´ë‹¤.
  - ```StudentConfig.java```: ë³¸ì¸ ê°™ì€ê²½ìš° commandLineRunnerë¥¼ ì—¬ê¸°ì—ë‹¤ê°€ ì§‘ì–´ë„£ì—ˆëŠ”ë°, Springì˜ ë‹¤ì–‘í•œ ì„¤ì •ì„ ì½”ë“œìƒì—ì„œ í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. (Bean)
  
  ### ğŸ“ Code
  
  - `Student.java`
    
    ```bash
    package com.example.backend.student;
    
    import java.time.LocalDate;
    import javax.persistence.*;
    
    // To connect with database
    @Entity
    @Table
    public class Student {
      // annotation to connect with database
      @Id
      @SequenceGenerator(
        name = "student_sequence",
        sequenceName = "student_sequence",
        allocationSize = 1
      )
      @GeneratedValue(
        strategy = GenerationType.SEQUENCE,
        generator = "student_sequence"
      )
    
      private Long id;
      private String name;
      private String email;
      private String text;
      private LocalDate date;
      // @Transient       --> no need to be the column in the database.
      //                      this will calculate the age for us.
      // private Integer age;
    
      // public Integer getAge() {
      //     return Period.between(this.dob, LocalDate.now()).getYears();
      // }
    
      public Student() {
      }
    
      public Student( String name, String email, String text, LocalDate date) {
    
        this.name = name;
        this.email = email;
        this.text = text;
        this.date = date;
      }
    
      public Student(Long id, String name, String email, String text, LocalDate date) {
        this.id = id;
        this.name = name;
        this.email = email;
        this.text = text;
        this.date = date;
      }
    
        // getter setter goes here...
    
    }
    ```
    
  - `StudentController.java`
    
    ```jsx
    package com.example.backend.student;
    
    import java.time.LocalDate;
    import java.util.List;
    
    import org.springframework.beans.factory.annotation.Autowired;
    import org.springframework.web.bind.annotation.GetMapping;
    import org.springframework.web.bind.annotation.RequestMapping;
    import org.springframework.web.bind.annotation.RestController;
    
    @RestController
    @RequestMapping(path="api/v1/post")
    public class StudentController {
      
      private final StudentService studentService;
    
      @Autowired
      public StudentController(StudentService studentService) {
        this.studentService = studentService;
      }
    
        // GET 
      @GetMapping 
      public List<Student> getAllStudents() {
        return studentService.getAllStudents();
      }
    }
    ```
    
  - `StudentService.java`
    
    ```jsx
    package com.example.backend.student;
    
    import java.util.List;
    
    import org.springframework.beans.factory.annotation.Autowired;
    import org.springframework.stereotype.Service;
    
    // @Component
    @Service
    public class StudentService {
    
      private final StudentRepository studentRepository;
    
      @Autowired
      public StudentService(StudentRepository studentRepository) {
        this.studentRepository = studentRepository;
      }
    
      public List<Student> getAllStudents() {
        return studentRepository.findAll();		// --> returns list for us.
    
        // return List.of(new Student(1L, "Dongha Kang", "dkang0602@gmail.com", "# HELLO WORLD ", LocalDate.of(2021, 9, 30) ));
      }
    }
    ```
    
  - `StudentRepository.java`
    
    ```jsx
    package com.example.backend.student;
    
    import org.springframework.data.jpa.repository.JpaRepository;
    import org.springframework.stereotype.Repository;
    
    // JpaRepository<T, ID>
    // interface is responsible for data access
    @Repository
    public interface StudentRepository extends JpaRepository<Student, Long>{
      // nothing goes here for now
    }
    ```
    
  - `StudentConfig.java`
    
    ```jsx
    package com.example.backend.student;
    
    import java.time.LocalDate;
    import java.util.List;
    
    import org.springframework.boot.CommandLineRunner;
    import org.springframework.context.annotation.Bean;
    import org.springframework.context.annotation.Configuration;
    
    @Configuration
    public class StudentConfig {
      
      @Bean
      CommandLineRunner commandLineRunner(StudentRepository studentRepository) {
        return args -> {
           Student dongha = new Student(1L, "Dongha Kang", "dkang0602@gmail.com", "# HELLO WORLD ", LocalDate.of(2021, 9, 30) ); 
    
           studentRepository.saveAll(List.of(dongha));
        };
      }
    }
    ```
    
  
  # ë‚´ì¼ í•  ê²ƒ ?
  
  - ğŸ“ Postgresql ì— Markdown íŒŒì¼ì´ ë“¤ì–´ê°€ëŠ”ì§€ í˜¹ì€ ê¸´ markdown textê°€ ë“¤ì–´ê°€ëŠ”ì§€ í™•ì¸í•´ë³¼ê²ƒì´ë‹¤
  - ğŸ¨ Postgresqlì— ì´ë¯¸ì§€ëŠ” ì–´ë–»ê²Œ ë„£ëŠ”ì§€, ì•„ë‹ˆ ê·¸ëƒ¥ .md íŒŒì¼ ìì²´ë¥¼ ë„£ìœ¼ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.