---
title: ğŸ“¡ useSWR
author: "Dongha Kang"
date: "2021-11-24"
tag: ["React"]
---

# SWRì´ë€ ?

> **SWR**ì€ ë¦¬ì•¡íŠ¸ìƒì—ì„œ httpë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜ fetch í• ë•Œ ìœ ìš©í• ë•Œ ì“°ì´ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ë°, ìºì‹œ/ìŠ¤íƒœì¼ ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°˜í™˜í•œ í›„, fetchìš”ì²­ì„ ì¬ê²€ì¦í•˜ê³  ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.
> 

```jsx
const fetcher = url => axios.get(url).then(res => res.data);
const { data, error } = useSWR(URL + '/fetch_practice/', fetcher);
```

ìœ„ì— ì˜ˆì‹œë¥¼ ë³´ë©´ keyëŠ” `URL + '/fetch_practice/'` ì´ë©°, ì´ ì‹ë³„ìëŠ” ë‚˜ì¤‘ì— ì‚¬ìš©ì´ë©ë‹ˆë‹¤. `fetcher`ëŠ” ë°ì´í„°ë¥¼ ë³€í™˜í•˜ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ ì…ë‹ˆë‹¤. 

ì¼ë°˜ì ì¸ fetching ë¿ë§Œ ì•„ë‹ˆë¼ ìœ„ì— ì˜ˆì‹œì²˜ëŸ¼ axiosë¥¼ ì‚¬ìš©í•´ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. 

í•˜ì§€ë§Œ, SWRì˜ ë¹›ì€ ë‹¹ì—°ì»¨ë° ì¬ì‚¬ìš© ê°€ëŠ¥ ì¸ ê²ƒ ê°™ë‹¤.

```jsx
function useUser (id) {
  const { data, error } = useSWR(`/api/user/${id}`, fetcher)

  return {
    user: data,
    isLoading: !error && !data,
    isError: error
  }
}
```

```jsx
function Avatar ({ id }) {
  const { user, isLoading, isError } = useUser(id)

  if (isLoading) return <Spinner />
  if (isError) return <Error />
  return <img src={user.avatar} />
}
```

ì´ëŸ°ì‹ìœ¼ë¡œ custom hook ì„ ë§Œë“¤ì–´ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ì´ SWR ë¥¼ ì‚¬ìš©í•˜ê²Œ ëœ ê³„ê¸°ëŠ” ë°”ë¡œ `mutate`ë¼ëŠ” ê¸°ëŠ¥ ë•Œë¬¸ì´ë‹¤.

**ë®¤í…Œì´íŠ¸**ë€ mutate(key)ë¥¼ ì‚¬ìš©í•´ì„œ ë™ì¼í•œ í‚¤ë¥¼ ê°€ì§„ í•¨ìˆ˜ë¥¼ ë¸Œë¡œë“œìºìŠ¤íŒ…í•˜ë©° ë¦¬ë¡œë”© í•˜ëŠ” ì‘ì—…ì„ ëœ»í•œë‹¤. 

```jsx
import { mutate } from 'swr';

...
function handleClick(groupName) {
  axios.post(URL + '/groups/', { id: -1, name: groupName })
  .then(() => {
    setStatus('ok');
    onClose();
  })
  .catch(err => setError({ status: true, message: 'Connection failed' }));
}
```

ì´ëŸ° ì‹ì— ì½”ë“œê°€ ìˆì—ˆë‹¤ê³  ê°€ì •í•˜ë©´, `post` í†µì‹ ì´ ì¢…ë£Œ ë˜ì—ˆì„ë•Œ, status ë¥¼ ok ë¡œ ë°”ê¾¸ì–´ì£¼ëŠ” `useState`ë§Œ ì‚¬ìš©ëœë‹¤ë¼ëŠ” ê²ƒì„ íŒŒì•…í•  ìˆ˜ ìˆë‹¤. 

ë§Œì•½ì— parent ì»´í¬ë„ŒíŠ¸ì— ë‹¤ë¥¸ í†µì‹ ì´ ì§„í–‰ì´ë˜ê³  ìˆê³  ìœ„ì— ì½”ë“œê°€ ë¬¼ë ¤ë°›ì€ ë°ì´í„°ë¥¼ ì´ìš©í•œ í†µì‹ ì´ë¼ë©´ component í†µì‹ ì´ ì™„ì „íˆ ì—…ë°ì´íŠ¸ ë˜ëŠ”ê²ƒì´ ì•„ë‹Œ status ë§Œ ë³€ê²½ëœë‹¤. ë¬¼ë¡  `useState`ë¥¼ ë‹¤ì‹œ ì´ìš©í•´ì„œ parent componentë¥¼ re-renderí•´ë„ ë˜ì§€ë§Œ, ë§Œì•½ ê·¸ëƒ¥ ìºì‹œ í†µì‹ ì„ ì´ìš©í•´ì„œ ìƒˆë¡œìš´ ë°ì´í„°ë¡œ re-rendering í•  ìˆ˜ ìˆëŠ” ë°©ë²•ë„ ìˆì„ ê²ƒì´ë‹¤. 

```jsx
import { mutate } from 'swr';

...
function handleClick(groupName) {
  axios.post(URL + '/groups/', { id: -1, name: groupName })
  .then(() => {
    setStatus('ok');
    mutate(URL + '/fetch_practice/');
    onClose();
  })
  .catch(err => setError({ status: true, message: 'Connection failed' }));
}
```

ì´ ì²˜ëŸ¼ swr ë¥¼ ì´ìš©í•´ì„œ ê¸°ì¡´ì— ìºì‹œì— ì €ì¥ë˜ì—ˆë˜ swrë¥¼ í‚¤ë¡œ ë¶ˆëŸ¬ì™€ì„œ ë‹¤ì‹œ ë Œë”ë§ í•œë‹¤ë©´, ì²˜ìŒ ê·¸ dataê°€ fetch ë˜ì—ˆë˜ ì»´í¬ë„ŒíŠ¸ëŠ” ë‹¤ì‹œ ë Œë”ë§ ë˜ê³  ê·¸ë ‡ê²Œ ë˜ë©´ ëª¨ë“  child componentë„ ë‹¤ì‹œ ì—…ë°ì´íŠ¸ ë  ê²ƒì´ë‹¤.

ì•„ì§ SWRë¥¼ ì œëŒ€ë¡œ ì‚¬ìš©í•´ë³´ì§€ë„, ì œëŒ€ë¡œ ì™„ë²½íˆ ì´í•´í•˜ì§€ëŠ” ëª»í–ˆì§€ë§Œ, ì´ëŸ° ë‘ê°€ì§€ë§Œ ì˜ ì‚¬ìš©í•´ë„ êµ‰ì¥íˆ ë¹ ë¥´ê³  í¸ë¦¬í•œ ë°ì´í„° í†µì‹ ì´ ë˜ì§€ ì•Šì„ê¹Œ ì‹¶ë‹¤.